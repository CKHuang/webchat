WE.userPage={};
WE.userPage.editAccount={init:function(){this.ui={itemWall:$("#edit-info").find(".edit-item"),nickNameWall:$("#nickname-wall"),desWall:$("#des-wall"),nameClose:$("#close-name"),nameSubmit:$("#submit-name"),desClose:$("#close-des"),desSubmit:$("#submit-des"),nameInput:$("#name-input"),desInput:$("#des-input")};this.regEvent()},regEvent:function(){var a=this;this.ui.nickNameWall.find(".display").click(function(){a.viewName()});this.ui.desWall.find(".display").click(function(){a.viewDes()});this.ui.nameClose.click(function(){a.hideName()});
this.ui.desClose.click(function(){a.hideDes()});this.ui.nameSubmit.click(function(){var b=$.trim(a.ui.nameInput.val());""!=b&&a.updateUserName(b)});this.ui.nameInput.keyup(function(b){13==b.keyCode&&a.ui.nameSubmit.click()});this.ui.desSubmit.click(function(){var b=$.trim(a.ui.desInput.val());""!=b&&a.updateUseDes(b)});this.ui.desInput.keyup(function(b){13==b.keyCode&&a.ui.desSubmit.click()})},viewName:function(){this.ui.nickNameWall.addClass("edit-item-select");this.ui.nickNameWall.find(".edit").removeClass("hidden");
this.ui.nickNameWall.find(".icon-user").removeClass("color-user-dark").addClass("color-user-white")},viewDes:function(){this.ui.desWall.addClass("edit-item-select");this.ui.desWall.find(".edit").removeClass("hidden");this.ui.desWall.find(".icon-list").addClass("color-list-white")},hideName:function(){this.ui.nickNameWall.removeClass("edit-item-select");this.ui.nickNameWall.find(".edit").addClass("hidden");this.ui.nickNameWall.find(".icon-user").addClass("color-user-dark").removeClass("color-user-white")},
hideDes:function(){this.ui.desWall.removeClass("edit-item-select");this.ui.desWall.find(".edit").addClass("hidden");this.ui.desWall.find(".icon-list").removeClass("color-list-white")},updateUserName:function(a){var b=this,c=new WE.api.UserModel,d=new WE.Controller;d.update=function(c){0==c.data.code&&(b.ui.nickNameWall.find(".display .info").text(a).removeClass("no-info"),b.hideName())};c.addObserver(d);c.updateUserName(a)},updateUseDes:function(a){var b=this,c=new WE.api.UserModel,d=new WE.Controller;
d.update=function(c){0==c.data.code&&(b.ui.desWall.find(".display .info").text(a).removeClass("no-info"),b.hideDes())};c.addObserver(d);c.updateUserSummery(a)}};
WE.userPage.editAvatar={init:function(){this.ui={submit:$("#avatar-submit"),radios:$("#select-item")};this.regEvent()},regEvent:function(){var a=this;this.ui.submit.click(function(){var b=a.ui.radios.find("input[type=radio]:checked").val();a.updateAvatar(b)})},updateAvatar:function(a){var b=new WE.api.UserModel,c=new WE.Controller;c.update=function(a){location.reload()};b.addObserver(c);b.updateAvator(a)}};
WE.userPage.bindMail={init:function(){this.ui={submit:$("#bindMail-submit"),input:$("#bindMail-input"),tips:$("#bindMail-tip")};this.regEvent()},regEvent:function(){var a=this;this.ui.submit.click(function(){var b=$.trim(a.ui.input.val());""!=b&&(/^[^@]+@[^@]+$/.test(b)?a.verifMail(b,a.updateMail,a.errorTip):a.errorTip("Please enter a valid email"))});this.ui.input.keyup(function(b){13==b.keyCode&&a.ui.submit.click()});this.ui.input.focus(function(b){a.ui.tips.addClass("hidden")})},verifMail:function(a,
b,c){var d=new WE.api.UserModel,e=new WE.Controller;e.update=function(d){0==d.data.code?b&&b(a):c&&c("Email is exit! please try others")};d.addObserver(e);d.verifMail(a)},updateMail:function(a){var b=new WE.api.UserModel,c=new WE.Controller;c.update=function(a){console.log(a.data)};b.addObserver(c);b.updateMail(a)},errorTip:function(a){var b=this;this.ui.tips.text(a).removeClass("hidden");setTimeout(function(){b.ui.tips.addClass("hidden")},2E3)}};
